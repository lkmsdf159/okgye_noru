# 옥계노루 출퇴근 관리 시스템 (okgye_noru)

<p align="center">
  알바생 출퇴근 관리 및 근무 시간 확인을 위한 Google Apps Script 기반 시스템
</p>

<p align="center">
  <a href="#소개">소개</a> •
  <a href="#주요-기능">주요 기능</a> •
  <a href="#시스템-구조">시스템 구조</a> •
  <a href="#사용-방법">사용 방법</a> •
  <a href="#기술-스택">기술 스택</a> •
  <a href="#개발-특징">개발 특징</a>
</p>

## 소개

이 프로젝트는 옥계노루 매장에서 알바생들의 출퇴근을 효율적으로 관리하기 위해 개발되었습니다. 대표님이 알바생들의 출퇴근을 확인할 때 발생하는 신뢰성 문제와 CCTV 확인으로 인한 스트레스 및 항상 주급과 월급 그리고 세금 계산과 주휴수당 계산을 카톡 보고를 일일이 기입하시는걸 보고 자동화 시스템 구축을 통해 해결하고자 했습니다.

자영업자는 복잡한 시스템보다 Google Spreadsheet와 같은 친숙한 도구를 선호하므로, Google Apps Script를 활용해 스프레드시트를 기반으로 하면서도 자동화된 기능을 제공합니다.

## 주요 기능

### 1. 알바생 출퇴근 관리 ⏱️
- 비밀번호 기반의 안전한 출퇴근 기록 시스템
- 10분 단위로 시간 반올림/내림 자동 처리
- 미퇴근 상태 자동 감지 및 처리

### 2. 급여 계산 자동화 💰
- 근무 시간 자동 계산
- 주휴수당 자동 계산 (주 15시간 이상 근무 시)
- 세금(3.3%) 자동 계산
- 주차별 근무 시간 및 급여 정보 제공

### 3. 알바생용 근무 확인 대시보드 📊
- 알바생이 자신의 근무 내역을 확인할 수 있는 대시보드
- 캘린더 형태의 직관적인 출퇴근 기록 표시
- 월간/주간 근무 요약 정보 제공

### 4. 보안 강화 🔒
- Cloudflare를 통해 대시보드 URL을 가려 실제 접근 경로 보호
- 출퇴근 페이지에 임의 접근을 방지하기 위한 보안 처리

## 시스템 구조

```
okgye_noru/
├── Code.gs                 # 백엔드 로직 (Google Apps Script)
├── Index.html              # 출퇴근 기록 페이지
├── Dashboard.html          # 근무 확인 대시보드
└── Cloudflare              # 접근 제한 설정
```

### Code.gs
Google Apps Script의 핵심 파일로, 다음과 같은 모듈로 구성되어 있습니다:

1. **상수 및 설정 모듈**
   - 시스템 전반에 사용되는 상수값 정의
   - 시트 이름, 날짜 포맷, 시급 등 설정

2. **유틸리티 모듈**
   - 시간 계산, 열 변환 등 유틸리티 함수 제공
   - 10분 단위 시간 반올림 처리

3. **시트 관리 모듈**
   - 시트 생성, 구조 분석, 유효성 검사 등 처리
   - 오래된 시트 자동 삭제 기능

4. **직원 관리 모듈**
   - 직원 정보 관리 및 비밀번호 검증
   - 직원 열 설정 및 관리

5. **출퇴근 기록 모듈**
   - 출퇴근 기록 처리
   - 미퇴근 상태 관리

6. **요약 정보 모듈**
   - 근무 시간, 급여 등 요약 정보 계산
   - 주차별 데이터 처리

7. **자동화 트리거 모듈**
   - 자동 시트 생성
   - 미퇴근 처리 자동화

8. **웹 앱 인터페이스**
   - 클라이언트와 서버 간 통신 처리

### Index.html
알바생이 사용하는 출퇴근 기록 페이지로, 모바일 최적화된 UI를 제공합니다:
- 직원 선택 드롭다운
- 비밀번호 입력란
- 출근/퇴근 버튼
- 실시간 시계 표시

### Dashboard.html
알바생이 자신의 근무 내역을 확인할 수 있는 대시보드입니다:
- 자신의 근무 내역 조회
- 달력 형태의 출퇴근 기록 표시
- 월간 근무 요약 정보 (총 근무 시간, 근무 일수)
- 주차별 근무 내역 요약

### Cloudflare
대시보드 URL을 가리고 보안을 강화하기 위한 장치입니다:
- iframe을 활용하여 실제 URL을 숨기고 Cloudflare 도메인으로 접근하도록 함
- 출퇴근 페이지에 임의로 접근하는 것을 방지

## 시트 구조

시스템은 다음과 같은 스프레드시트 구조를 사용합니다:

1. **직원목록 시트**
   - 직원 정보 및 비밀번호 저장
   - 시급 정보 관리

2. **월별 출퇴근기록 시트**
   - 'N월_출퇴근기록' 형식의 월별 시트
   - 날짜/요일/주차 열
   - 직원별 출근시간/퇴근시간/근무시간 열
   - 근무 요약 정보 섹션 (총 근무 시간, 주차별 시간 등)

## 자동화 기능

- **자동 미퇴근 처리**: 전날 퇴근 기록이 없는 경우 자동으로 '미퇴근' 처리
- **월별 시트 자동 생성**: 새로운 달이 시작될 때 해당 월의 시트 자동 생성
- **오래된 시트 자동 삭제**: 두 달 전 시트는 자동으로 삭제되어 스프레드시트 용량 관리
- **근무시간 자동 계산**: 출퇴근 시간 입력 시 근무시간 자동 계산

## 사용 방법

### 출퇴근 기록 (알바생)
1. 출퇴근 페이지 접속: 기본 URL로 접속
2. 이름 선택: 드롭다운에서 자신의 이름 선택
3. 비밀번호 입력: 부여받은 비밀번호 입력
4. 출퇴근 버튼 클릭: 출근/퇴근 시 해당 버튼 클릭

### 근무 내역 확인 (알바생)
1. 대시보드 접속: Cloudflare 도메인으로 접속 (실제 `/exec?page=worklog` 경로는 숨겨짐)
2. 직원 선택: 좌측의 직원 목록에서 자신의 이름 선택
3. 기간 선택: 상단의 연도/월 선택기로 확인하고 싶은 기간 선택
4. 근무 내역 확인: 달력 형태로 표시된 출퇴근 기록 및 근무 시간 확인
5. 요약 정보 확인: 월간 총 근무 시간, 근무 일수, 주차별 근무 시간 확인

## 기술 스택

- **백엔드**: Google Apps Script (GAS)
- **프론트엔드**: HTML, CSS, JavaScript
- **데이터베이스**: Google Spreadsheet
- **보안**: Cloudflare Workers

## 개발 특징

1. **모듈화된 코드 구조**
   - 기능별로 모듈화하여 유지보수성을 높임
   - 각 모듈은 독립적으로 동작하도록 설계

2. **자동화된 계산 로직**
   - 근무 시간, 주휴수당, 세금 등 복잡한 계산을 자동화
   - 스프레드시트 수식을 활용한 효율적인 데이터 처리

3. **반응형 UI**
   - 모바일 환경에서도 사용하기 편리한 반응형 디자인
   - 직관적인 사용자 인터페이스

4. **오류 처리**
   - 다양한 예외 상황(미출근, 미퇴근 등)을 고려한 로직
   - 디버깅을 위한 로깅 시스템 구현

5. **보안 고려사항**
   - 비밀번호는 서버 측에서 검증되어 안전하게 처리
   - Cloudflare Workers를 통한 접근 제한
   - 급여 정보 등 민감한 내용은 대시보드에서 제외

이 시스템은 Google Apps Script의 특성을 활용하여 별도의 서버 인프라 없이도 안정적으로 운영할 수 있으며, 자영업자가 쉽게 접근하고 관리할 수 있는 구조로 설계되었습니다.
